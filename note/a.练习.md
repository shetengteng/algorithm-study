## 数据结构与算法应用

### 题目1

10万条记录，每一个记录有ID，积分，等其他信息，如何存储这些信息完成如下操作

- 依据ID快速查找、替换、更新、删除数据
- 查找积分在某个区域的对象ID
- 查询积分从小到大排在第x位的对象ID
- 查找按照积分从小到大排名在[x,y]之间的对象ID列表

解决：按照**ID**将对象信息组织成**散列表**，可以依据ID快速查找，替换更新信息，按照**积分**将对象信息组织成**跳表**数据结构，按照积分查询时间复杂度就是O(logn)，针对第三个和第四个操作，需要在每个索引节点中加入一个span字段，用于记录这个索引节点到下一个索引节点包含的链表节点个数，利用跳表索引，快速计算积分排名位置的ID。实际使用中，可以使用redis有序集合来实现。

### 题目2

电商交易系统，订单数目一般比较大，分库10个，在不加入复杂的分库分表的中间件的情况下，快速的查询金额最大的前k个订单

- 在数据库中，订单表的金额上建立有索引，通过select order by limit 获取数据库中的数据
- 服务器内存有限，设计要尽量节省内存

解决：使用select order by limit 各取局部金额最大的订单，把取出的10个订单（有由于10个数据库）放入**优先级队列**（顶堆）中，取出最大值（全局最大订单），然后再从该最大订单的数据库找到下一条（按照订单金额从大到小排列），放入优先级队列中，不断重复该过程，直到找到金额前K的大订单。需要注意的是，sql的查询效率，一次性不能读取的数据太多或者太少，要依据实际的硬件性能测试找到合适的 大小。

### 题目3

cpu资源有限，任务处理的速度和线程的个数不是正相关的，过多的线程会导致cpu的频繁切换，处理器性能下降，线程池的大小都是综合考虑任务处理的特点和硬件环境来设置

当固定大小的线程池中请求线程资源，如果线程池中没有空闲，线程如何处理这个请求？拒绝还是排队请求？各种处理策略如何？

在队列学习中有解答。

### 题目4

通过ip地址查找ip的归属地的功能，通过维护一个的ip地址库实现，包含ip地址的范围和归属地的对应关系，如查询202.102.133.24这个ip地址范围在[202.102.133.0-202.102.133.255]，则对应该范围的归属地就可得到。

```shell
[202.102.133.0, 202.102.133.255]  山东东营市 
[202.102.135.0, 202.102.136.255]  山东烟台 
[202.102.156.34, 202.102.157.255] 山东青岛 
[202.102.48.0, 202.102.48.255] 江苏宿迁 
[202.102.49.15, 202.102.51.251] 江苏泰州 
[202.102.56.0, 202.102.56.255] 江苏连云港
```

如果从地址库中一一查找，那么是非常耗时的，如果有12万条ip区间的数据，如何匹配？

使用二分查找来解决

### 题目5

设计一个简单的海量图片存储系统，最大预期可以存储1亿张图片

- 存储一张图片以及图片的元信息，图片名称，tag信息，如图片名称：玫瑰花，tag信息红色，花，情人节
- 依据关键字搜索一张图片，关键字是 情人节，花，玫瑰花
- 避免重复插入相同的图片，不能单纯的使用图片的元信息，来比对是否是同一个图片，因为有可能存在名称相同，但图片内容不同，或者不同图片，内容相同

自助开发一个简单系统，不希望借助复杂的三方系统，如mysql，redis，GFS等，单台机器性有限，硬盘1T，内存2G，如何设计符合上面的要求，操作高效，使用机器最少？

解决：

使用哈希算法，功能分为2个部分

- 依据元数据的搜索功能
  - 使用搜索引擎的**倒排索引结构**，由于一个图片对应一组元信息，如题目中所说，一个图片会对应一组元信息，比如玫瑰花对应{红色，花，情人节}，牡丹花对应{白色，花}，我们可以将这种图片与元信息之间的关系，倒置过来建立索引。“花”这个关键词对应{玫瑰花，牡丹花}，“红色”对应{玫瑰花}，“白色”对应{牡丹花}，“情人节”对应{玫瑰花}。
  - 搜索的时候，查询“花”得到{玫瑰花，牡丹花}，查询“情人节”得到{玫瑰花}，对2个关键字取其交集，得到{玫瑰花}
- 图片判重，基于图片本身判重，使用哈希算法，对图片取hash值，建立相应的hash表，判断图片是否存在。

### 题目6

散列表的查询效率不能严格的说是O(1)，它与散列函数，装载因子，散列冲突都有关系；极端情况下，恶意攻击者，通过设计的数据经过散列之后，都放在一个槽子里面，造成散列冲突，导致查询效率降低，散列表会退化为链表，查询的复杂度是O(n)

如何设计一个工业级的散列表？参考散列表一章